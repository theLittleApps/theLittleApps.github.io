<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    ç›¸é‡çš„ä¸€åˆ»ï¼Œç•¶ Objective-C é‡åˆ°äº† SwiftUI ä¸¨
    

    thelittleapps
  </title>

  
  <link rel="shortcut icon" href="/logo.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- å­—ä½“ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">The Little Apps</a>
    <ul class="nav">
      
      <li><a href="/archives">blogs</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">ç›¸é‡çš„ä¸€åˆ»ï¼Œç•¶ Objective-C é‡åˆ°äº† SwiftUI</div>
  <div class="post-meta">
    <div class="date">2024 August 30th</div>
    <div class="tags">
      
    </div>
  </div>
  

  <main class="post-content"><p>é›–ç„¶ <strong>SwiftUI</strong> å·²ç¶“å•ä¸–äº”å¹´äº† (<a target="_blank" rel="noopener" href="https://developer.apple.com/wwdc19/204">WWDC2019</a>)ï¼Œä½†å¯¦å‹™ä¸Šå¯« iOS çš„ç¢¼è¾²ï¼Œå¤§éƒ½é‚„åœ¨ç¶­è­· <strong>Objective-C</strong> æ’°å¯«çš„å°ˆæ¡ˆå§ï¼å°¤å…¶æ˜¯é™³å¹´è€ codeï¼Œä¸åƒæ˜¯ç¾é…’ä¸€æ¨£è¶Šé™³è¶Šé¦™ï¼Œåè€Œæ˜¯è¶Šé™³è¶Šè¦ºå¾—é›£ä»¥ååš¥ï¼Œå¹»æƒ³å¦‚æœæœ‰ä¸€å¤©å…¨éƒ½è®Šæˆæ¼‚äº®çš„éšå¥³ (<strong>Swift</strong>) ï¼Œè€Œä¸”å…¨éƒ½ç”¨ <strong>SwiftUI</strong> ä¾†åŒ–å¦ï¼Œé‚£è©²æœ‰å¤šå¥½å•Šï¼</p>
<p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/01_objectiiveC_meet_swiftUI.webp" alt="01_objectiiveC_meet_swiftUI"></p>
<p>è˜‹æœæ•™ä¸»è½åˆ°å¤§å”å€‘å¿ƒè£¡çš„å‘¼å–Šï¼Œæ´¾äº† <strong><code>UIHostingController</code></strong> ä»™å¥³ä¸‹å‡¡ï¼Œä¾†æ»¿è¶³ä¸€çœ¾æ­»è‚¥å®…å€‘çš„æ˜¥å¤¢ï¼Œåœ¨é¾é˜è€ code ä¸­ï¼ŒåµŒå…¥ SwiftUI é€™ä½çº–çº–ç¾å°‘å¥³ã€‚</p>
<hr>
<h2 id="STEP1-å…ˆä¾†ç”¢ç”Ÿ-SwiftUI"><a href="#STEP1-å…ˆä¾†ç”¢ç”Ÿ-SwiftUI" class="headerlink" title="STEP1 å…ˆä¾†ç”¢ç”Ÿ SwiftUI"></a>STEP1 å…ˆä¾†ç”¢ç”Ÿ SwiftUI</h2><p>åœ¨ <strong>Objective-C</strong> çš„å°ˆæ¡ˆä¸­ <strong>New File</strong>ï¼Œå¤§è†½çš„é¸æ“‡ <strong>SwiftUI View</strong></p>
<p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/02_create_swiftui.webp" alt="02_create_swiftui"></p>
<p>è²¼å¿ƒçš„ <strong>Xcode</strong>ï¼Œæœƒè©¢å•æ‚¨è¦ä¸è¦ç”¢ç”Ÿä¸€å€‹ <strong>Bridging Header</strong> çš„æ¨™é ­æª” ( å¦‚æœå°ˆæ¡ˆæ²’ç”¢ç”Ÿéï¼Œä½ ä¹Ÿå¯åœ¨å°ˆæ¡ˆè¨­å®šä¸­è‡ªè¡Œè¨­å®šå®ƒçš„åå­— )ï¼Œé€™å€‹æª”ä¸»è¦æ˜¯æ‹¿ä¾†åš <strong>Objective-C</strong> èˆ‡ <strong>Swift</strong> æºé€šçš„æ©‹æ¨‘ï¼Œåœ¨é€™ <strong>.h</strong> ä¸­ <strong>import</strong> <strong>Objective-C</strong> å¯«çš„ <strong>.h</strong>ï¼Œå°±å¯ä»¥åœ¨ <strong>Swift</strong> ä¸­ï¼Œå‘¼å« <strong>OC ( Objective-C )</strong> å¯«çš„å‡½å¼ (function)ã€‚</p>
<p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/03_generate_bridge_file.webp" alt="03_generate_bridge_file"></p>
<p>å¦‚ä¸‹çš„ <strong>SwiftUI</strong></p>
<pre><code class="highlight stylus">import SwiftUI

struct HelloView: View &#123;
    <span class="selector-tag">var</span> <span class="selector-tag">body</span>: some View &#123;
        ZStack &#123;
            Color<span class="selector-class">.blue</span><span class="selector-class">.opacity</span>(<span class="number">0.6</span>)
                <span class="selector-class">.ignoresSafeArea</span>()
            <span class="built_in">Text</span>(<span class="string">&quot;Hello, Objective-C&quot;</span>)
                <span class="selector-class">.font</span>(.title)
                <span class="selector-class">.foregroundStyle</span>(.white)
        &#125;
    &#125;
&#125;

<span class="selector-id">#Preview</span> &#123;
    <span class="built_in">HelloView</span>()
&#125;
</code></pre>

<p>å¯« SwiftUI çš„å¥½è™•ï¼Œå°±æ˜¯åœ¨ç•«é¢å³é‚Šå¯ä»¥å³æ™‚è¦‹åˆ° UI çš„æ¸²æŸ“ï¼Œä¸ç”¨åƒç›²åŠå®¢ä¸€æ¨£ï¼Œå…¨é æƒ³åƒä¾†å¯« code ç•« UI äº†ã€‚</p>
<p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/04_program_in_SwiftUI.webp" alt="04_program_in_SwiftUI"></p>
<hr>
<h2 id="STEP2-å†ä¾†ç”¢ç”Ÿä¸€-View-Controller-UIKit"><a href="#STEP2-å†ä¾†ç”¢ç”Ÿä¸€-View-Controller-UIKit" class="headerlink" title="STEP2 å†ä¾†ç”¢ç”Ÿä¸€ View Controller ( UIKit )"></a>STEP2 å†ä¾†ç”¢ç”Ÿä¸€ View Controller ( UIKit )</h2><p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/05_select_cocoa_touch.webp" alt="05_select_cocoa_touch"></p>
<p>é¸æ“‡ç”± <strong>UIViewController</strong> ç¹¼æ‰¿ï¼Œèªè¨€ <strong>Swift</strong></p>
<p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/06_generate_uiviewctr.webp" alt="06_generate_uiviewctr"></p>
<p>å¦‚ä¸‹ Swift</p>
<pre><code class="highlight stylus">import UIKit
import SwiftUI

class HelloViewController: UIViewController &#123;

    override func <span class="built_in">viewDidLoad</span>() &#123;
        super<span class="selector-class">.viewDidLoad</span>()
        
        let helloView = <span class="built_in">HelloView</span>()
        <span class="comment">// the key:UIHostingController is the bridge between UIKit and SwiftUI</span>
        let hostCtr = <span class="built_in">UIHostingController</span>(rootView: helloView)
        
        <span class="comment">// add this hosting controller to our view controller</span>
        <span class="built_in">addChild</span>(hostCtr)
        view<span class="selector-class">.addSubview</span>(hostCtr.view)
        
        <span class="comment">// set auto layout constraints of hosting controller</span>
        hostCtr<span class="selector-class">.view</span><span class="selector-class">.translatesAutoresizingMaskIntoConstraints</span> = false
        hostCtr<span class="selector-class">.view</span><span class="selector-class">.topAnchor</span><span class="selector-class">.constraint</span>(equalTo: view<span class="selector-class">.topAnchor</span>, constant: <span class="number">0</span>)<span class="selector-class">.isActive</span> = true
        hostCtr<span class="selector-class">.view</span><span class="selector-class">.bottomAnchor</span><span class="selector-class">.constraint</span>(equalTo: view<span class="selector-class">.bottomAnchor</span>, constant: <span class="number">0</span>)<span class="selector-class">.isActive</span> = true
        hostCtr<span class="selector-class">.view</span><span class="selector-class">.leadingAnchor</span><span class="selector-class">.constraint</span>(equalTo: view<span class="selector-class">.leadingAnchor</span>, constant: <span class="number">0</span>)<span class="selector-class">.isActive</span> = true
        hostCtr<span class="selector-class">.view</span><span class="selector-class">.trailingAnchor</span><span class="selector-class">.constraint</span>(equalTo: view<span class="selector-class">.trailingAnchor</span>, constant: <span class="number">0</span>)<span class="selector-class">.isActive</span> = true
        
        <span class="comment">// notify hosting controller that has been added to parent view controller</span>
        hostCtr<span class="selector-class">.didMove</span>(toParent: self)
    &#125;
&#125;</code></pre>

<p>é€™ view controller çš„ç›®çš„ï¼Œå°±æ˜¯ä½œç‚º <strong>SwiftUI View</strong> çš„è¼‰å…·ï¼Œæœ¬èº« <strong>HelloViewController</strong> ç¹¼æ‰¿ <strong>UIKit</strong> æ¡†æ¶çš„ <strong>UIViewController</strong>ï¼Œåœ¨ <strong>viewDidLoad</strong> ä¸­ï¼Œä½¿ç”¨è˜‹æœä»™å¥³ <strong>UIHostingController</strong> ä¾†åˆå§‹åŒ–æˆ‘å€‘è¨­è¨ˆçš„ <strong>HelloView</strong>ï¼Œåˆå§‹åŒ–å®Œæˆå¾Œï¼Œå†ç”¨å¹³å¸¸ <strong>UIKit</strong> åŠ  <strong>subview controller</strong> çš„æ–¹æ³•ï¼ŒæŠŠä»™å¥³åŠ é€² <strong>HelloViewController</strong> ä¸­ã€‚</p>
<hr>
<h2 id="STEP3-Objective-C-ç™»å ´"><a href="#STEP3-Objective-C-ç™»å ´" class="headerlink" title="STEP3 Objective-C ç™»å ´"></a>STEP3 Objective-C ç™»å ´</h2><p>è¦è®“ OC ä½¿ç”¨ Swift æ’°å¯«çš„ code å¾ˆç°¡å–®ï¼Œåªè¦åœ¨ OC çš„ <strong>.m</strong> ä¸­ï¼Œ<strong>import</strong> ä»¥ä¸‹å…©å€‹ <strong>.h</strong> å³å¯ï¼š</p>
<pre><code class="highlight clean">#<span class="keyword">import</span> <span class="string">&quot;WelcomeSwiftUI-Bridging-Header.h&quot;</span>
#<span class="keyword">import</span> <span class="string">&quot;WelcomeSwiftUI-Swift.h&quot;</span></code></pre>


<p>ç¬¬ä¸€å€‹ <strong>.h</strong> å°±æ˜¯åœ¨æ­¥é©Ÿä¸€ <strong>Xcode</strong> ç”Ÿæˆçš„ <strong>Bridging Header</strong> æª”ï¼Œè€Œç¬¬äºŒå€‹ <strong>.h</strong> å‰‡æ˜¯ <strong>Swift</strong> æœƒè‡ªå‹•ç”Ÿæˆçš„æ¨™é ­æª”ï¼Œç›®çš„æ˜¯çµ¦ OC çœ‹çš„ï¼Œè®“ OC å¯ä»¥è—‰æ­¤å‘¼å« <strong>Swift</strong> å¯«çš„å‡½å¼ (function)</p>
<p><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swift/importing-swift-into-objective-c">Importing Swift into Objective-C | Apple Developer Documentation</a></p>
<hr>
<h2 id="STEP4-åœ¨-Objective-C-è£¡ä½¿ç”¨-Swift"><a href="#STEP4-åœ¨-Objective-C-è£¡ä½¿ç”¨-Swift" class="headerlink" title="STEP4 åœ¨ Objective-C è£¡ä½¿ç”¨ Swift"></a>STEP4 åœ¨ Objective-C è£¡ä½¿ç”¨ Swift</h2><p>çµ‚æ–¼å¯ä»¥åœ¨ OC çš„ view ä¸­è²¼ä¸Š SwiftUI view äº†ï¼Œå¦‚ç¯„ä¾‹åœ¨ <strong>OC storyboard</strong> ä¸­çš„ <strong>view container</strong>ï¼Œç›´æ¥å°±å¯ä»¥è¨­å®šæˆ swift å¯«çš„ <strong>HelloViewController</strong></p>
<p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/07_container_view.webp" alt="07_container_view"></p>
<p>åŸ·è¡Œçµæœï¼š<strong>view controller</strong> çš„ä¸ŠåŠéƒ¨æ˜¯ç”¨ <strong>OC ( UIKit )</strong> ï¼Œä¸‹åŠéƒ¨æ˜¯ <strong>Swift ( SwiftUI )</strong> ã€‚é…· ğŸ˜</p>
<p><img src="https://thelittleappsblogsbucket.s3.ap-northeast-1.amazonaws.com/meetTogether/08_simulator_result.webp" alt="08_simulator_result"></p>
<p>åƒè€ƒå°ˆæ¡ˆï¼š<a target="_blank" rel="noopener" href="https://github.com/theLittleApps/WelcomeSwiftUI">theLittleApps&#x2F;WelcomeSwiftUI</a></p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p>&#x3D;&gt; <a target="_blank" rel="noopener" href="https://medium.com/@kusalprabathrajapaksha/integrating-swiftui-into-objective-c-projects-two-effective-approaches-daa250fe195c">Integrating SwiftUI into Objective-C Projects: Two Effective Approaches</a><br>&#x3D;&gt; <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=B5-1_aR20rE">How to Use Child ViewControllers (Container Views) in Swift - Programmatic &amp; Storyboard</a><br>&#x3D;&gt; <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/uihostingcontroller?source=post_page-----4eda5147e55a--------------------------------&utm_source=pocket_saves">UIHostingController | Apple Developer Documentation</a></p>
<hr>
<h3 id="è´ŠåŠ©æˆ‘å€‘"><a href="#è´ŠåŠ©æˆ‘å€‘" class="headerlink" title="è´ŠåŠ©æˆ‘å€‘"></a>è´ŠåŠ©æˆ‘å€‘</h3><p><a href="https://www.buymeacoffee.com/thelittleapps" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/default-yellow.png" alt="Buy Me A Coffee" height="41" width="174"></a></p>
</main>
</article>
<div>
  <section id="comments" class="comments">
    <style>
      .utterances{max-width: 100%;}
    </style>
    <script src="https://utteranc.es/client.js"
      repo="theLittleApps/theLittleApps.github.io"
      issue-term="url"
      theme="preferred-color-scheme"
      crossorigin="anonymous"
      async>
    </script>
  </section>
</div>

<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright Â© 2024 The Little Apps</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>